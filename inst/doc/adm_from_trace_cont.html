<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Niklas Hohmann" />


<title>Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating Age-Depth Models from Tracer
Contents of Rocks and Sediments</h1>
<h4 class="author">Niklas Hohmann</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette gives an example on how to estimate age-depth models
(ADMs) from tracer contents of rocks and sediments using the function
<code>strat_cont_to_multiadm</code>. The function takes the following
inputs:</p>
<ul>
<li><p><code>h_tp</code> : a function that returns stratigraphic height
of the tie points</p></li>
<li><p><code>t_tp</code> : a function that returns times of the tie
points</p></li>
<li><p><code>strat_cont_gen</code> : a function that returns tracer
contents observed in the section, outcrop, or drillcore</p></li>
<li><p><code>time_cont_gen</code> : a function that returns how tracer
input into the sediment changed with time</p></li>
<li><p><code>h</code> : vector of heights where the ADMs are
estimated</p></li>
<li><p><code>no_of_rep</code> : integer, number of age-depth models
determined</p></li>
</ul>
<div id="idea" class="section level3">
<h3>Idea</h3>
<p>Assume there is a tracer embedded in rocks or sediment (e.g. Pollen,
extraterrestrial 3He, etc.). In addition, there some information on the
temporal variations of the tracer available. Then the tracer values
measure in the sediment can be compared to the assumed input flux of the
tracer to construct rates of sediment accumulation, from which an
age-depth model can be constructed.</p>
<p>A standard example is when tracer input into the sediment is
constant. The high tracer values reflect low rates of sediment
accumulation, which is equivalent to a low gradient of the age-depth
model.</p>
<p>This idea is formalized using the idea of stratigraphic content and
time content: Stratigraphic content is the tracer value measured in the
section (units tracer per length unit), and time content is the input of
tracer into the sediment (units tracer per time unit).</p>
</div>
<div id="coding-tie-points" class="section level3">
<h3>Coding tie points</h3>
<p>Times and heights of tie points are coded via the functions
<code>t_tp</code> (timing) and <code>h_tp</code> (height) that take no
inputs. They serve as wrappers around user-defined procedures that
reflect uncertainties around tie points. Every time <code>t_tp</code>
and <code>h_tp</code> are evaluated, they return possible values for the
tie points. Writing these functions requires some effort, but it allows
the user to hand over arbitrarily complex uncertainties of the tie
points to the <code>strat_cont_to_multiadm</code> function.</p>
<p>The function for the heights of the tie points must return a named
vector with entries <code>h1</code> and <code>h2</code>, corresponding
to the heights of the first (lower) and second (upper) tie point.
<code>h1</code> must be smaller than <code>h2</code>.</p>
<p>For this example, I assume the stratigraphic positions of the tie
points are known without uncertainty, and are at 10 and 20 m
stratigraphic height.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>h_min <span class="ot">=</span> <span class="dv">10</span> <span class="co"># stratigraphic height of lower tie point [m]</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>h_max <span class="ot">=</span> <span class="dv">20</span> <span class="co"># stratigraphic height of upper tie point [m]</span></span></code></pre></div>
<p><code>h_tp</code> is then implemented as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>h_tp <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;h1&quot;</span> <span class="ot">=</span> h_min,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>           <span class="st">&quot;h2&quot;</span> <span class="ot">=</span> h_max))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>}</span></code></pre></div>
<p>When evaluated, this function returns the stratigraphic positions of
the tie points:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">h_tp</span>()</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; h1 h2 </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 10 20</span></span></code></pre></div>
<p>The function for the timing of the tie points must return a named
vector with names “t1” (timing of first tie point) and “t2” (timing of
second tie point). “t1” must be smaller than “t2”.</p>
<p>For this example, I assume that the timing of the first tie point
follows a normal distribution with mean 0 and standard deviation 0.5.
For the second tie point, only maximum and minimum time is available.
Due to the lack of information, I assume a uniform distribution between
the minimum (9) and the maximum (11). This is implemented as follows in
<code>t_tp</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>t_tp <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="co"># timing first tie point</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  t1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="co"># timing second tie point</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  t2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">min =</span> <span class="dv">9</span>, <span class="at">max =</span> <span class="dv">11</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;t1&quot;</span> <span class="ot">=</span> t1, <span class="st">&quot;t2&quot;</span> <span class="ot">=</span> t2))</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Using Myr as time unit, the distribution of times for the tie points
is as follows:</p>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="coding-stratigraphic-data" class="section level3">
<h3>Coding stratigraphic data</h3>
<p>Both stratigraphic contents and age contents must be coded as
function factories, i.e., functions that return functions. They must be
able to take vector inputs and return a vector of the same length as
output.</p>
<p>I assume the tracer input into the sediment is constant with time.
This is implemented with the following function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>time_cont_gen <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  time_cont <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x)))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">return</span>(time_cont)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>}</span></code></pre></div>
<p>To visualize this, let’s plot this from time 0 to 10:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># generate one function from time_cont_gen</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>time_cont <span class="ot">=</span> <span class="fu">time_cont_gen</span>()</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># time where to evaluate the function</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">time_cont</span>(t),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time [Myr]&quot;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Tracer Input into the Sediment [1/Myr]&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For the tracer measured in the section, I assume it was measured at
the bottom, middle, and top of the examined section:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>locations <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;h_1&quot;</span> <span class="ot">=</span> h_min, <span class="st">&quot;h_2&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">c</span>(h_min, h_max)), <span class="st">&quot;h_3&quot;</span> <span class="ot">=</span> h_max)</span></code></pre></div>
<p>At these locations, tracer values each follow a normal distribution
with mean 10, 1, and 8 and standard deviations 1, 0.1, and 0.2.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>mean_vals <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mu_1&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="st">&quot;mu_2&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;mu_3&quot;</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>sd_vals <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sig_1&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;sig_2&quot;</span> <span class="ot">=</span> <span class="fl">0.1</span>, <span class="st">&quot;sig_3&quot;</span> <span class="ot">=</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p>I assume that between the measured points, tracer values change
linearly. With these assumptions and values, the function factory for
the tracer can be coded as follows</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>strat_cont_gen <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>   loc <span class="ot">=</span> locations</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>   trac_vals <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">length</span>(mean_vals),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                     <span class="at">mean =</span> mean_vals,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                     <span class="at">sd =</span> sd_vals)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>   strat_cont <span class="ot">=</span> <span class="fu">approxfun</span>(<span class="at">x =</span> loc,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                          <span class="at">y =</span> trac_vals,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                          <span class="at">yleft =</span> trac_vals[<span class="dv">1</span>],</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                          <span class="at">yright =</span> trac_vals[<span class="dv">3</span>])</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>   <span class="fu">return</span>(strat_cont)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>}</span></code></pre></div>
<p>To visualize this, here are 3 possible scenarios of how tracer values
change in the section:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co"># number of sampled tracer values </span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">seq</span>(h_min, h_max, <span class="at">by =</span> <span class="fl">0.1</span>) <span class="co"># determine age-depth model every 0.1 m</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(h_min, h_max),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mean_vals) <span class="sc">+</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">max</span>(sd_vals)),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Stratigraphic Height [m]&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Measured Tracer [1/m]&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n)){</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  strat_cont <span class="ot">=</span> <span class="fu">strat_cont_gen</span>()</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> h,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">strat_cont</span>(h),</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>        <span class="at">col =</span> cols[i])</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="estimating-the-age-depth-model" class="section level2">
<h2>Estimating the age-depth model</h2>
<p>With all the input data coded, age-depth models can be estimated
using the function <code>strat_cont_to_multiadm</code>. Here, I
determine the age-depth models every 0.25 m, and generate 10 ADMs</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">seq</span>(h_min,h_max, <span class="at">by =</span> <span class="fl">0.25</span>) <span class="co"># strat. positions where ADMs are estimated</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>no_of_rep <span class="ot">=</span> <span class="dv">10</span> <span class="co"># no. of ADMs estimated</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>my_adm <span class="ot">=</span> <span class="fu">strat_cont_to_multiadm</span>(<span class="at">h_tp =</span> h_tp,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                                <span class="at">t_tp =</span> t_tp,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                <span class="at">strat_cont_gen =</span> strat_cont_gen,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                                <span class="at">time_cont_gen =</span> time_cont_gen,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                <span class="at">h =</span> h,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                                <span class="at">no_of_rep =</span> no_of_rep)</span></code></pre></div>
<p>The estimated age-depth model can be handed to plot to display
it:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(my_adm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="further-information" class="section level2">
<h2>Further information</h2>
<p>For information on estimating age-depth models from sedimentation
rates, see</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;adm_from_sedrate&quot;</span>)</span></code></pre></div>
</div>
<div id="see-also" class="section level2">
<h2>See also</h2>
<p>For a simplified application see</p>
<ul>
<li>Jarochowska, E., Nohl, T., Grohganz, M., Hohmann, N., Vandenbroucke,
T. R. A., &amp; Munnecke, A. (2020). Reconstructing depositional rates
and their effect on paleoenvironmental proxies: The case of the Lau
Carbon Isotope Excursion in Gotland, Sweden. Paleoceanography and
Paleoclimatology, 35, e2020PA003979. <a href="https://doi.org/10.1029/2020PA003979">DOI:
10.1029/2020PA003979</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
