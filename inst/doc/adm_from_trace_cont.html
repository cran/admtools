<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Niklas Hohmann" />


<title>Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating Age-Depth Models from Tracer
Contents of Rocks and Sediments</h1>
<h4 class="author">Niklas Hohmann</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette gives an example on how to estimate age-depth models
(ADMs) from tracer contents of rocks and sediments using the function
<code>strat_cont_to_multiadm</code>. The function takes the following
inputs:</p>
<ul>
<li><p><code>h_tp</code> : a function that returns stratigraphic height
of the tie points</p></li>
<li><p><code>t_tp</code> : a function that returns times of the tie
points</p></li>
<li><p><code>strat_cont_gen</code> : a function that returns tracer
contents observed in the section, outcrop, or drillcore</p></li>
<li><p><code>time_cont_gen</code> : a function that returns how tracer
input into the sediment changed with time</p></li>
<li><p><code>h</code> : vector of heights where the ADMs are
estimated</p></li>
<li><p><code>no_of_rep</code> : integer, number of age-depth models
determined</p></li>
</ul>
<div id="idea" class="section level3">
<h3>Idea</h3>
<p>Assume there is a tracer embedded in rocks or sediment (e.g. Pollen,
extraterrestrial 3He, etc.). In addition, there some information on the
temporal variations of the tracer available. Then the tracer values
measure in the sediment can be compared to the assumed input flux of the
tracer to construct rates of sediment accumulation, from which an
age-depth model can be constructed.</p>
<p>A standard example is when tracer input into the sediment is
constant. The high tracer values reflect low rates of sediment
accumulation, which is equivalent to a low gradient of the age-depth
model.</p>
<p>This idea is formalized using the idea of stratigraphic content and
time content: Stratigraphic content is the tracer value measured in the
section (units tracer per length unit), and time content is the input of
tracer into the sediment (units tracer per time unit).</p>
</div>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>We construct a floating age-depth model for a section of 5 m
thickness from measurements of extraterrestrial 3He based on the
assumption that 3He flux is constant with time.</p>
<div id="data" class="section level3">
<h3>Data</h3>
<p>We start by defining the section, the sampling bins, and the
measurements of 3He:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>h_min <span class="ot">=</span> <span class="dv">3</span> <span class="co"># bottom of section</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>h_max <span class="ot">=</span> <span class="dv">8</span> <span class="co"># top of section</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>sampling_bin_borders <span class="ot">=</span> <span class="fu">seq</span>(h_min, h_max, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># limits of sampling bins</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>mean_3He <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">15</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="fu">length</span>(sampling_bin_borders) <span class="sc">-</span> <span class="dv">1</span>) <span class="co"># assumed 3He mean vals</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>sd_3He <span class="ot">=</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">length</span>(mean_3He), <span class="at">min =</span> <span class="fl">0.1</span> <span class="sc">*</span> mean_3He, <span class="at">max =</span> <span class="fl">0.2</span> <span class="sc">*</span> mean_3He) <span class="co"># standard deviation of 3He</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>He_measurements <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">&quot;mean&quot;</span> <span class="ot">=</span> mean_3He, <span class="st">&quot;sd&quot;</span> <span class="ot">=</span> sd_3He)</span></code></pre></div>
<p>We want to know the age every 10 cm, so we define</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">seq</span>(h_min, h_max, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>T_unit <span class="ot">=</span> <span class="st">&quot;dimensionless&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>L_unit <span class="ot">=</span> <span class="st">&quot;m&quot;</span></span></code></pre></div>
</div>
<div id="tie-points" class="section level3">
<h3>Tie points</h3>
<p>The tie points in height are deterministic and defined using the
function <code>tp_height_det</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>tp_height <span class="ot">=</span> <span class="fu">tp_height_det</span>(<span class="at">heights =</span> <span class="fu">c</span>(h_min, h_max))</span></code></pre></div>
<p>We use the function <code>tp_time_floating_scale</code> to define the
time tie points for the floating time scale</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tp_time <span class="ot">=</span> <span class="fu">tp_time_floating_scale</span>()</span></code></pre></div>
<p>This introduces an auxiliary time scale where the bottom of the
section corresponds to time 0 and the top to time 1, which allows to
examine the relative distribution of time within the section.</p>
</div>
<div id="tracer-values" class="section level3">
<h3>Tracer values</h3>
<p>To define the assumption of constant 3He flux in time, we use the
function <code>flux_const</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>flux <span class="ot">=</span> <span class="fu">flux_const</span>()</span></code></pre></div>
<p>The observations of 3He are put into a machine-readable format using
the function <code>strat_cont_gen_from_tracer</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>observed_tracer <span class="ot">=</span> <span class="fu">strat_cont_gen_from_tracer</span>(<span class="at">bin_borders =</span> sampling_bin_borders, </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                                          <span class="at">df =</span> He_measurements,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                                          <span class="at">distribution =</span> <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p>Because the 3He measurements are uncertain, values returned from
<code>observed_tracer</code> will differ every time the function is
evaluated. As example, we plot three realizations of the tracer values
with depth:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimate-age-depth-model" class="section level3">
<h3>Estimate age depth model</h3>
<p>With the tie points, assumptions on flux in time, and observed values
of the tracer coded, we can now estimate the age-depth model:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>my_adm <span class="ot">=</span> <span class="fu">strat_cont_to_multiadm</span>(<span class="at">h_tp =</span> tp_height,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                                <span class="at">t_tp =</span> tp_time,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                                <span class="at">strat_cont_gen =</span> observed_tracer,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                                <span class="at">time_cont_gen =</span> flux,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                                <span class="at">h =</span> h,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                                <span class="at">T_unit =</span> T_unit,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                                <span class="at">L_unit =</span> L_unit)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(my_adm, <span class="at">mode =</span> <span class="st">&quot;envelope&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">T_axis_lab</span>()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">L_axis_lab</span>()</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">make_legend</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>You can extract mean, median, and quantile age-depth models using
<code>mean_adm</code>, <code>median_adm</code> and
<code>quantile_adm</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>mean_adm <span class="ot">=</span> <span class="fu">mean_adm</span>(my_adm, h)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">plot</span>(mean_adm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="coding-tie-points" class="section level2">
<h2>Coding tie points</h2>
<div id="background" class="section level3">
<h3>Background</h3>
<p>Times and heights of tie points are coded via the functions
<code>t_tp</code> (timing) and <code>h_tp</code> (height) that take no
inputs. They serve as wrappers around user-defined procedures that
reflect uncertainties around tie points. Every time <code>t_tp</code>
and <code>h_tp</code> are evaluated, they return possible values for the
tie points. Conceptually, both <code>t_tp</code>and <code>h_tp</code>
are user implemented random number generators that draw from the
distributions of tie points. Writing these functions requires some
effort, but it allows the user to hand over arbitrarily complex
uncertainties of the tie points to the
<code>strat_cont_to_multiadm</code> function.</p>
</div>
<div id="wrappers" class="section level3">
<h3>Wrappers</h3>
<p>Multiple wrappers are available to simplify coding tie points:</p>
<ul>
<li><p><code>tp_height_det</code> for specifying deterministic
stratigraphic heights</p></li>
<li><p><code>tp_time_det</code> for specifying deterministic time
points</p></li>
<li><p><code>tp_time_floating_scale</code> to encode time tie points for
floating time scale</p></li>
<li><p><code>tp_time_norm</code> for normally distributed tie points in
time</p></li>
</ul>
</div>
<div id="manually-coding-tie-points" class="section level3">
<h3>Manually coding tie points</h3>
<p>Both <code>t_tp</code> and <code>h_tp</code> must return strictly
ordered numeric vectors of times/heights. This means that it is the
users responsibility to avoid inversions of times/heights.</p>
<p>As an example, I assume the stratigraphic positions of the tie points
are known without uncertainty, and are at 10 and 20 m stratigraphic
height.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>h_min <span class="ot">=</span> <span class="dv">10</span> <span class="co"># stratigraphic height of lower tie point [m]</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>h_max <span class="ot">=</span> <span class="dv">20</span> <span class="co"># stratigraphic height of upper tie point [m]</span></span></code></pre></div>
<p><code>h_tp</code> is then implemented as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>h_tp <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(h_min, h_max))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>}</span></code></pre></div>
<p>When evaluated, this function returns the stratigraphic positions of
the tie points:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">h_tp</span>()</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; [1] 10 20</span></span></code></pre></div>
<p>Note that the <code>h_tp</code> defined here is a synonym for
<code>h_tp = tp_height_det(c(h_min, h_max))</code>.</p>
<p>For a more complex example, I assume that the timing of the first tie
point follows a normal distribution with mean 0 and standard deviation
0.5. For the second tie point, only maximum and minimum time is
available. Due to the lack of information, I assume a uniform
distribution between the minimum (9) and the maximum (11). This is
implemented as follows in <code>t_tp</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>t_tp <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="cf">repeat</span>{ </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="co"># timing first tie point</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    t1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="co"># timing second tie point</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    t2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">min =</span> <span class="dv">9</span>, <span class="at">max =</span> <span class="dv">11</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="cf">if</span> (t1 <span class="sc">&lt;</span> t2){ <span class="co"># if order is correct, return values</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">c</span>(t1, t2))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    }</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  }</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">t_tp</span>() <span class="co"># evaluating the function returns a random pair of times drawn from the specified distribution</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.197580 9.243056</span></span></code></pre></div>
<p>Using Myr as time unit, the distribution of times for the tie points
is as follows:</p>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="coding-tracer-data-and-hypothesis" class="section level2">
<h2>Coding tracer data and hypothesis</h2>
<div id="background-1" class="section level3">
<h3>Background</h3>
<p>Mathematically, tracer data and hypothesis are assumed to be
stochastic processes. With each iteration of the estimation procedure, a
sample path is generated from the stochastic processes. This sample path
reflects one possible change of tracer values in the section/time, given
our uncertainties of tracer measurements.</p>
<p>Computationally, this is implemented using <em>function
factories</em>, which are functions that return functions. A function
factory defines a stochastic process, and each function <span class="math inline">\(f\)</span> generated by a function factory is a
sample path. In turn, <span class="math inline">\(f(x)\)</span> returns
the value of the sample path at <span class="math inline">\(x\)</span>
.</p>
<p>Here, function factories are used as complex random number
generators: Instead of returning one or multiple random numbers, they
return a random function.</p>
</div>
<div id="wrappers-1" class="section level3">
<h3>Wrappers</h3>
<p>Available wrappers are</p>
<ul>
<li><p><code>flux_const</code> : assume constant flux in time</p></li>
<li><p><code>flux_linear</code>: linear change in flux in time</p></li>
<li><p><code>flux_quad</code>: quadratic change in flux in time</p></li>
<li><p><code>strat_cont_gen_from_tracer</code>: use empirical tracer
data in stratigraphic domain</p></li>
</ul>
</div>
<div id="manually-coding-tracer-data-and-hypothesis" class="section level3">
<h3>Manually coding tracer data and hypothesis</h3>
<p>Both stratigraphic contents and time contents must be coded as
function factories, i.e., functions that return functions. They must be
able to take vector inputs and return a vector of the same length as
output, and always return strictly positive values.</p>
<p>For example, assume the tracer input into the sediment is constant
with time. This is implemented with the following function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>time_cont_gen <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  time_cont <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">return</span>( <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x)))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">return</span>(time_cont)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that the inner function is a function of x (time), while the
outer function takes no arguments - it simply returns the inner
function. To visualize this, let’s plot this from time 0 to 10:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># generate one function from time_cont_gen</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>time_cont <span class="ot">=</span> <span class="fu">time_cont_gen</span>()</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># time where to evaluate the function</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">time_cont</span>(t),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time [Myr]&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Tracer Input into the Sediment [X/Myr]&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This is a lot of effort to code a constant function. The used
approach shows its power and versatility when used in more complex
situations. For example, assume the tracer was measured at the bottom,
middle, and top of the examined section:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>h_min <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>h_max <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>locations <span class="ot">=</span> <span class="fu">c</span>( h_min,  <span class="fu">mean</span>(<span class="fu">c</span>(h_min, h_max)),  h_max)</span></code></pre></div>
<p>At these locations, tracer values measured follow a normal
distribution with mean 10, 1, and 8 and standard deviations 1, 0.1, and
0.2.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>mean_vals <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>,  <span class="dv">1</span>,  <span class="dv">8</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>sd_vals <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.8</span>)</span></code></pre></div>
<p>I assume that between the measured points, tracer values change
linearly. With these assumptions and values, the function factory for
the tracer can be coded as follows</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>strat_cont_gen <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="co"># draw sample tracer values from specified distributions</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>   trac_vals <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">length</span>(mean_vals),</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                     <span class="at">mean =</span> mean_vals,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                     <span class="at">sd =</span> sd_vals)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>   <span class="co"># define function that linearly interpolates between drawn values</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>   strat_cont <span class="ot">=</span> <span class="fu">approxfun</span>(<span class="at">x =</span> locations,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>                          <span class="at">y =</span> trac_vals,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>                          <span class="at">yleft =</span> trac_vals[<span class="dv">1</span>],</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>                          <span class="at">yright =</span> trac_vals[<span class="dv">3</span>])</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>   <span class="fu">return</span>(strat_cont)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>}</span></code></pre></div>
<p>To visualize this, here are 3 possible scenarios of how tracer values
change in the section:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co"># number of sampled tracer values </span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">seq</span>(h_min, h_max, <span class="at">by =</span> <span class="fl">0.1</span>) <span class="co"># determine tracer values every 0.1 m </span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(h_min, h_max),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mean_vals) <span class="sc">+</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">max</span>(sd_vals)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Stratigraphic Height [m]&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Measured Tracer [1/m]&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n)){</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  strat_cont <span class="ot">=</span> <span class="fu">strat_cont_gen</span>() <span class="co"># draw sample path from stoch process </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="co"># draw sample path</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> h,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">strat_cont</span>(h),</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>        <span class="at">col =</span> cols[i])</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="further-information" class="section level2">
<h2>Further information</h2>
<p>For information on estimating age-depth models from sedimentation
rates, see</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;adm_from_sedrate&quot;</span>)</span></code></pre></div>
<p>For details on plotting ADMs see</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;adm_plotting)</span></span></code></pre></div>
<p>For an overview of the structure of the <code>admtools</code> package
and the classes used therein see</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;admtools_doc&quot;</span>)</span></code></pre></div>
</div>
<div id="see-also" class="section level2">
<h2>See also</h2>
<p>For a simplified application see</p>
<ul>
<li>Jarochowska, E., Nohl, T., Grohganz, M., Hohmann, N., Vandenbroucke,
T. R. A., &amp; Munnecke, A. (2020). Reconstructing depositional rates
and their effect on paleoenvironmental proxies: The case of the Lau
Carbon Isotope Excursion in Gotland, Sweden. Paleoceanography and
Paleoclimatology, 35, e2020PA003979. <a href="https://doi.org/10.1029/2020PA003979">DOI:
10.1029/2020PA003979</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
